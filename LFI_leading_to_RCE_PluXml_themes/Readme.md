# Local File Inclusion via Path Traversal leading to Remote Command Execution in PluXml themes.

PluXml version 5.8.7 suffer from Local File Inclusion vulnerability due to improper sanitisations of themes directory location.
This allows attacker inclusion of arbitrary web server files, which can be upgraded to Remote Command Execution allowing access to the web server's
underlying operating system.

# LFI PoC:
1) Open static page  

![1](https://user-images.githubusercontent.com/57464251/177345915-8f27dfe1-5b91-4ade-baf0-c37eb91b2d1e.png)

2) Edit static page, intercept the request with proxy. Change 'template' parameter with 'passwd'  

![First_step](https://user-images.githubusercontent.com/57464251/177346015-eff510fd-36ef-4c2c-853f-ef7819617d6c.png)

3) Change theme, intercept the request with proxy. Change 'style' parameter with '../../../../../../../../etc/'  

![Step_two](https://user-images.githubusercontent.com/57464251/177346383-decd1048-b5b8-4a8d-a673-9b833524b252.png)

4) New template will be created.  

![2022-07-05 15_18_01-Kali Linux 2020 4 - VMware Workstation 16 Player (Non-commercial use only)](https://user-images.githubusercontent.com/57464251/177346825-871cd28c-db75-4e1f-bdc7-9cb1883fb90b.png)

5) Refresh already opened (step 1) static page site.  

![Refresh](https://user-images.githubusercontent.com/57464251/177346955-d189116f-28c6-4499-b7d5-dd80e21fe78c.png)

6) /etc/passwd file will be included.  

![PoC](https://user-images.githubusercontent.com/57464251/177347096-343c945c-b4d1-44b1-a756-7bddeb330545.png)


# RCE PoC
1) In basic configuration change any parameter, for example site description to php code.  

![1)](https://user-images.githubusercontent.com/57464251/177347390-d077fa03-1d11-40b3-97fe-3c3d8355e712.png)

2) Change static page 'template' parameter to 'parametres.xml'.  

![Rce_step2](https://user-images.githubusercontent.com/57464251/177347584-05166496-5d49-4926-ae8f-1e9bbf804bdf.png)

3) Change themes 'style' parameter to '../data/configuration/'

![Rce_step3](https://user-images.githubusercontent.com/57464251/177347789-41a3a34d-583c-4a6e-88f4-b14bf492c4ac.png)

4) Open the static page site, and refresh the page.

![Rce_step4](https://user-images.githubusercontent.com/57464251/177347871-afe1a747-67c6-4862-9062-93d5dc018781.png)

5) Command output will be seen, confirming RCE.  

![Rce_step5](https://user-images.githubusercontent.com/57464251/177348067-e95eb485-0e81-4cff-98ba-44c0fcb88036.png)

